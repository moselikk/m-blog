---
layout: post
title: 'mac企业监管机屏蔽弹窗'
date: 2020-08-21 17:33:00 +0800
categories:
---

1. 解除系统的 rootless 限制，即 SIP（system integrity protection）系统完整性保护。
   方法是：关机，按住【Cmd+R】键重启，进入 recovery 恢复模式，在菜单【实用工具】中打开终端，输入`csrutil disable`禁用它，然后查看`csrutil status`是否已经禁用成功，然后退出重启（输入`reboot`）,重新启动 。

2. 正常进入系统，打开终端，尝试 sudo nano 或者 sudo vi 你的文件，看看能不能保存，如果还不行的话就执行 sudo mount -uw /把系统挂载为可写，直到重启前都有效。
   超级管理员权限 Sudo -s
   更改/System/Library/读写权限
   是因为苹果系统认为这些文件太重要，于是就限定了所有被修改和操作的可能。注意这里限定是指 restricted，而不是 lock 锁定。
   使用`ls -lO /system/...filepath`可以查看到系统文件的属性中都带有 restricted 字样，这种文件 sudo 也动不了。
   很多教程中说要改的 plist 文件都是限定的文件.

3. 去应用介面，找到其他里的“终端”启用并插入以下代码：

```bash
sudo mkdir /System/Library/LaunchAgentsDisabled; sudo mkdir /System/Library/LaunchDaemonsDisabled;
sudo mv /System/Library/LaunchAgents/com.apple.ManagedClientAgent.agent.plist /System/Library/LaunchAgentsDisabled;
sudo mv /System/Library/LaunchAgents/com.apple.ManagedClientAgent.enrollagent.plist /System/Library/LaunchAgentsDisabled;
sudo mv /System/Library/LaunchDaemons/com.apple.ManagedClient.cloudconfigurationd.plist /System/Library/LaunchDaemonsDisabled;
sudo mv /System/Library/LaunchDaemons/com.apple.ManagedClient.enroll.plist /System/Library/LaunchDaemonsDisabled;
sudo mv /System/Library/LaunchDaemons/com.apple.ManagedClient.plist /System/Library/LaunchDaemonsDisabled;
sudo mv /System/Library/LaunchDaemons/com.apple.ManagedClient.startup.plist /System/Library/LaunchDaemonsDisabled
```

4. 设置完毕重新开启 SIP
   与关闭的步骤类似，只是在第一步中输入`csrutil enable`即可。
